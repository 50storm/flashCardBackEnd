# ğŸ§­ é–‹ç™ºãƒãƒ‹ãƒ¥ã‚¢ãƒ«ï¼ˆDocker + PHPç’°å¢ƒï¼‰

## æ¦‚è¦
æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€**PHP ã®ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ composer ã«ã‚ˆã‚Šç®¡ç†**ã—ã€  
ç”Ÿæˆã•ã‚ŒãŸ `vendor/` ã‚’ **Git ã§ã‚³ãƒŸãƒƒãƒˆã—ã¦å…±æœ‰** ã—ã¾ã™ã€‚

ã“ã®æ§‹æˆã«ã‚ˆã‚Šï¼š
- é–‹ç™ºç’°å¢ƒã¨æœ¬ç•ªç’°å¢ƒã®å·®ç•°ã‚’æ’é™¤  
- PHPãƒ»Composer ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³å·®ç•°ã‚’é˜²æ­¢  
- ä¾å­˜é–¢ä¿‚ã®å†ç¾æ€§ã‚’ä¿è¨¼

---

## ğŸš€ åŸºæœ¬ãƒ«ãƒ¼ãƒ«

| é …ç›® | æ–¹é‡ |
|------|------|
| ãƒ©ã‚¤ãƒ–ãƒ©ãƒªè¿½åŠ ãƒ»æ›´æ–° | ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ `composer require` ã‚’å®Ÿè¡Œ |
| ã‚¯ãƒ©ã‚¹è¿½åŠ ãƒ»å‰Šé™¤ | `composer dump-autoload` ã‚’å®Ÿè¡Œ |
| `vendor/` | **Git ç®¡ç†å¯¾è±¡ï¼ˆå‰Šé™¤ç¦æ­¢ï¼‰** |
| ãƒ›ã‚¹ãƒˆç’°å¢ƒã§ composer å®Ÿè¡Œ | âŒ ç¦æ­¢ï¼ˆç’°å¢ƒä¸æ•´åˆé˜²æ­¢ã®ãŸã‚ï¼‰ |

---

## ğŸ§© é–‹ç™ºæ‰‹é †

### åˆå›æ™‚ã€Dockerfileã‚’å¤‰æ›´ã—ãŸå ´åˆã¯å†ãƒ“ãƒ«ãƒ‰ï¼š

```bash
docker-compose build --no-cache
```

---

### 1ï¸âƒ£ ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•

```bash
docker-compose up -d
```

---

### 2ï¸âƒ£ ã‚³ãƒ³ãƒ†ãƒŠã«å…¥ã‚‹

```bash
docker exec -it php-app bash
```

ï¼ˆ`php-app` ã¯ `docker-compose.yml` ã® `container_name`ï¼‰

---

### 3ï¸âƒ£ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¿½åŠ ãƒ»æ›´æ–°

```bash
composer require ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å
```

ä¾‹ï¼š

```bash
composer require zircote/swagger-php
```

ã“ã‚Œã«ã‚ˆã‚Šï¼š
- `/var/www/html/vendor` ã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒè¿½åŠ ã•ã‚Œã‚‹  
- ãƒ›ã‚¹ãƒˆã® `vendor/`ãƒ»`composer.json`ãƒ»`composer.lock` ã«ã‚‚è‡ªå‹•åæ˜ ã•ã‚Œã‚‹ï¼ˆvolumeå…±æœ‰ã®ãŸã‚ï¼‰

---

### 4ï¸âƒ£ ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ãƒ»å‰Šé™¤ã—ãŸå ´åˆ

ã‚ªãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ã‚’å†ç”Ÿæˆï¼š

```bash
composer dump-autoload
```

> âš ï¸ ã‚¯ãƒ©ã‚¹è¿½åŠ ãƒ»å‰Šé™¤ãƒ»ãƒªãƒãƒ¼ãƒ æ™‚ã¯å¿…ãšå®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚

---

### 5ï¸âƒ£ å¤‰æ›´å†…å®¹ã‚’ Git ã«åæ˜ 

ãƒ›ã‚¹ãƒˆå´ã§ï¼š

```bash
git add vendor composer.json composer.lock
git commit -m "Update dependencies (via container composer)"
```

---

## ğŸ“‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆä¾‹

```
flashCardBackEnd/
â”œâ”€â”€ docker/
â”‚   â””â”€â”€ php/
â”‚       â””â”€â”€ Dockerfile
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ Controller/
â”‚   â”œâ”€â”€ Model/
â”‚   â””â”€â”€ swagger.php        â† Swaggerå®šç¾©ãªã©
â”œâ”€â”€ doc/
â”‚   â””â”€â”€ openapi.yaml
â”œâ”€â”€ vendor/                â† ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆGitç®¡ç†å¯¾è±¡ï¼‰
â”œâ”€â”€ composer.json
â”œâ”€â”€ composer.lock
â””â”€â”€ docker-compose.yml
```

---

## ğŸ§  ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰ã¾ã¨ã‚

| æ“ä½œ | ã‚³ãƒãƒ³ãƒ‰ |
|------|-----------|
| ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹• | `docker-compose up -d` |
| ã‚³ãƒ³ãƒ†ãƒŠã«å…¥ã‚‹ | `docker exec -it php-app bash` |
| ãƒ©ã‚¤ãƒ–ãƒ©ãƒªè¿½åŠ  | `composer require ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å` |
| ã‚ªãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼æ›´æ–° | `composer dump-autoload` |
| Swaggerãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ | `./vendor/bin/openapi --output ./doc/openapi.yaml ./src` |
| ã‚³ãƒ³ãƒ†ãƒŠåœæ­¢ | `docker-compose down` |

---

## âš™ï¸ æ³¨æ„äº‹é …

- `rm -rf vendor` ã¯çµ¶å¯¾ã«å®Ÿè¡Œã—ãªã„ã“ã¨ï¼ˆä¾å­˜é–¢ä¿‚ãŒæ¶ˆå¤±ã—ã¾ã™ï¼‰  
- `composer.lock` ã¯å‰Šé™¤ã›ãšã€å¿…ãšã‚³ãƒŸãƒƒãƒˆã™ã‚‹ã“ã¨  
- ãƒ›ã‚¹ãƒˆå´ã§ `composer install` ã‚„ `require` ã‚’å®Ÿè¡Œã—ãªã„ã“ã¨  
- PHPãƒ»Composer ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸å†…ã§å›ºå®šç®¡ç†ã•ã‚Œã¦ã„ã¾ã™  

---

## ğŸ§¾ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

| ç—‡çŠ¶ | å¯¾å¿œæ–¹æ³• |
|------|-----------|
| ã‚³ãƒ³ãƒ†ãƒŠãŒç«‹ã¡ä¸ŠãŒã‚‰ãªã„ | `docker logs php-app` ã§ãƒ­ã‚°ç¢ºèª |
| `openapi: not found` | ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ `composer require zircote/swagger-php` ã‚’å®Ÿè¡Œ |
| `@OA\Info() not found` | `src/swagger.php` ã«åŸºæœ¬ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ  |

---

## âœ… ã¾ã¨ã‚

- Composer ã¯ **ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã®ã¿æ“ä½œ**  
- `vendor` ã¨ `composer.lock` ã¯ **Git ç®¡ç†å¿…é ˆ**  
- ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ãƒ»å‰Šé™¤ã—ãŸã‚‰ **`composer dump-autoload`**

---

âœï¸ Author: *Project FlashCard Backend Team*
